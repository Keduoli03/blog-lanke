---
import { hero, author } from '@/config.json'
import { SocialList } from './SocialList'
import Highlight from '@/components/Highlight.astro'
import { Icon } from 'astro-icon/components'
const defaultYiyan = 'å½“ç¬¬ä¸€é¢—å«æ˜Ÿé£å‘å¤§æ°”å±‚å¤–ï¼Œæˆ‘ä»¬ä¾¿ä»¥ä¸ºè‡ªå·±ç»ˆæœ‰ä¸€æ—¥ä¼šå¾æœå®‡å®™ã€‚'
const yiyanSource = hero.yiyan || ''
const yiyanIsUrl = /^https?:\/\//.test(yiyanSource)
---

<div class="lg:-mt-16 lg:h-dvh lg:min-h-[720px]">
  <div
    class="relative max-w-[1300px] mx-auto h-full px-4 grid lg:grid-cols-2 items-center justify-items-center"
  >
    <div class="mt-[120px] lg:mt-0 max-w-[590px]">
      <h1 class="text-3xl text-center lg:text-left text-balance">
        Hi there, I'm <Highlight class="font-bold">{hero.name}</Highlight>ğŸ‘‹<br />{hero.bio}
      </h1>
      <div class="text-sm text-secondary mt-3 text-center lg:text-left">{hero.description}</div>
      <SocialList className="mt-[60px]" client:load />
    </div>
    <div class="mt-20 lg:mt-0">
      <div
        class="size-[200px] lg:size-[300px] rounded-full overflow-hidden border border-primary bg-zinc-100 dark:bg-zinc-800"
      >
        <img class="size-full" src={author.avatar} alt="Site owner avatar" loading="lazy" />
      </div>
    </div>

    <div class="mt-10 lg:mt-0 lg:absolute inset-x-0 bottom-0 flex flex-col items-center">
      <p
        id="yiyan-text"
        class="text-xs text-center text-balance text-secondary"
        data-source={hero.yiyan}
        data-default={defaultYiyan}
      >
        {yiyanIsUrl ? defaultYiyan : hero.yiyan || defaultYiyan}
      </p>
      <script is:inline>
        ;(() => {
          const el = document.getElementById('yiyan-text')
          if (!el) return
          const src = el.getAttribute('data-source') || ''
          const fallback = el.getAttribute('data-default') || el.textContent || ''
          const setFromData = (d) => {
            const t = (d && (d.hitokoto ?? d.text ?? d.content ?? d.sentence)) || ''
            const from = (d && (d.from_who || d.from)) || ''
            const text = t ? (from ? `${t} â€”â€” ${from}` : t) : fallback
            el.textContent = text
          }
          const load = () => {
            if (!/^https?:\/\//.test(src)) {
              el.textContent = src || fallback
              return
            }
            const url = src + (src.includes('?') ? '&' : '?') + '_t=' + Date.now()
            fetch(url, { cache: 'no-store' })
              .then((r) => r.json())
              .then(setFromData)
              .catch(() => {
                el.textContent = fallback
              })
          }
          load()
          const onSwup = () => {
            if (location.pathname === '/' || location.pathname === '') load()
          }
          document.addEventListener('swup:content:replace', onSwup)
        })()
      </script>
      <div class="mt-7 text-xl animate-bounce">
        <Icon name="ri:arrow-down-s-line" />
      </div>
    </div>
  </div>
</div>
